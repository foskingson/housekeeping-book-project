# 지갑 톡톡 (가계부 웹) :blue_book:
![지갑 톡톡 홈 화면](./img/지갑%20톡톡.png)

<br>
<br>

## 기능
- 달력
- 각각의 날짜에 대한 금액 표시 및 관리 (카드지출과 현금지출 분리)
- 총 금액 표시
<br>
<br>

## Development Environment
- 프론트엔드 : 
<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white"> <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> <img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black">

- 백엔드 : 
<img src="https://img.shields.io/badge/node.js-339933?style=for-the-badge&logo=Node.js&logoColor=white"> <img src="https://img.shields.io/badge/express-000000?style=for-the-badge&logo=express&logoColor=white"> <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">

<br>
<br>

## 어려웠던 점(그걸 통해 배운점)

### 서버파일과 클라이언트파일의 연결
- 원래는 lib폴더안에 template.js를 만들어 함수로 클라이언트파일을 만들었는데 그렇게 하다보니 서버측에서 클라이언트로 동적 데이터를 넘길때 불편한 경우가 많았다.
JavaScript 템플릿 리터럴에서는 템플릿 문자열 내부에 줄바꿈을 포함해도 구문 측면에서 문제가 발생하지 않지만 HTML에서 들여쓰기가 있을때 공백을 렌더링해 발생하는 오류라던지
함수의 return 값으로 `` 백틱안의 html파일을 주었는데 그안에서도 백틱을 이용해야 편리한 부분들이 많았다 하지만 백틱안에서 백틱을 사용하지 못하는 한계가 있었고 해당 어려움을
뷰엔진을 사용하여 서버파일과 클라이언트파일의 연결을 좀더 매끄럽게 할 수 있었다.
<br>

### 데이터베이스 구조 설계의 중요성
- 만들면서 가장 어려웠던 것 중 하나가 달력의 각 날짜에 지출한 금액을 다 다르게 표시되게 하는 것이였다.
ejs파일에서는 데이터베이스를 사용할수 없어서 main파일에서 데이터베이스 구조를 잘 설계해 클라이언트쪽으로 보내줘야 각각의 날짜와 맞는 금액을
표시되게 할수 있었다. 처음에는 아무것도 없는 테이블에다가 create를 할때 생겨나게 하는 방식을 사용했었다.
하지만 이런 방식을 사용하면 create를 하기전에 웹에 표시될때 정의되지 않아 오류가 나는 부분이 많았다.
 따라서 나는 웹을 실행하면 현재 월에 해당하는 테이블을 만들고 기본적으로 그안에 id, date와 금액을 초기화 해놨었다 (date는 각 날짜 금액은 다 0으로)
이렇게 해놓고 create를 할 경우 해당되는 날짜의 값이 수정되는 UPDATE쿼리문으로 수정하였다. 
해당 방법을 통해 정리를 하니 ejs파일에서 데이터베이스의 값을 main에서 가져와 사용할때 id값이 결국 day값과 동일하게 만들어 
연결을 쉽게 하였다.
<br>

### 소켓통신
- 클라이언트의 요청이 있을때 서버가 응답하는 HTTP통신과 달리 실시간으로 클라이언트와 서버가 양방향으로 통신하는 방식이다.
- 전체 페이지를 로드하지 않고 웹페이지를 새로운 데이터로 업데이트 할 수 있다.
- 내가 만든 가계부 달력은 '/' 최상위경로에서 1~12월 까지 이전달/다음달 버튼을 이용해서 월을 이동하고 이동한 월의 데이터를 다시 클라이언트로 보내줘야 했다. 어떤 방식으로 데이터를 보내줄지 찾아보던 중 소켓통신에 대해 알게 되었다. 먼저 서버측 코드에서 소켓통신을 위해 socket.io 라이브러리를 사용해 서버와 웹소켓 연결을 설정했고 `io.emit`을 사용하여 클라이언트에게 데이터를 지정하여 보내주었다.
클라이언트 측 코드에서도 웹소켓 통신을 위해 웹소켓 라이브러리를 가져와 웹소켓 연결을 설정하고 서버에서 데이터를 수신할 때마다 클라이언트 렌더링을 업데이트 시켜주었다. 결론적으로 웹 소켓 통신을 위해 클라이언트에서 현재 웹 페이지가 보고 있는 달을 서버에게 http통신으로 넘겨주면 그 때마다 서버에서 해당 달의 데이터를 웹 소켓 통신으로 클라이언트로 넘겨줄 수 있었다. 
<br>



### 페이지를 로드했을때 직전의 데이터 상태 유지
- 현재달이 아닌쪽에서 create를 했을때 그 달의 데이터를 유지한 상태로 웹페이지를 리다이렉션 하고 싶었는데 '/'로 리다이렉션을 하면 초기의 설정값을 현재의 날짜로 잡아놔서 2월에서 지출금액을 추가했을때 현재달인 1월로 옮겨졌었다. (ex: 현재달 : 2024년 1월 , create한 달 : 2024년 2월 => create를 했을때 1월로 돌아가지 않고 2월 데이터 상태로 리다이렉트) 이번 프로젝트에서는 create를 했을때 쿼리 매개변수를 추가하여 리다이렉션을 하여 해결하였다. 원래는 쿼리매개변수를 추가하지 않고 세션이나 쿠키를 이용하여 '/'로 이동해도 create하기 직전 달의 데이터를 유지하고 싶었는데 계속해보아도 오류가 나거나 제대로 기능을 하지 않아 쿼리매개변수를 추가하게 되었다. 나중에 한번 다시 도전해봐야할 것 같다.
<br>


### 만들어본 후기
- nodejs를 간단하게 배우고 뭐라도 만들고 싶은 생각에 만들게 되었다. 처음으로 만들어본 개인 프로젝트이기도 하고 개발하기전 기본적인 설계에 대한 이론적인 개념을 모른 상태에서 하나의 어플리케이션을 만들어본다는것과 기능이 동작하고 오류가 안나는것에만 집중해 코드가 정리가 안되어있고 난잡하다. 모르는 부분은 검색을 해보거나 chatgpt를 통해 찾아보면서 만들었다. 다음에 프로젝트를 하게되면 데이터베이스 구조부터 mvc패턴 등 다양한 설계에 대한 이론을 공부하고 제대로 설계해서 스프링으로 다시 한번 만들어 볼 것이다.
